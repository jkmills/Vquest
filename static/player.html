<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Player View</title>
</head>
<body>
  <h1>Player</h1>
  <label>Name <input id="name"></label>
  <label>Room <input id="code"></label>
  <button id="join">Join</button>

  <div id="action" style="display:none;">
    <input id="actionText" placeholder="Your action">
    <button id="sendAction">Send</button>
  </div>

  <script>
    let playerId;
    document.getElementById('join').onclick = async () => {
      const name = document.getElementById('name').value;
      const code = document.getElementById('code').value;
      const res = await fetch(`/room/${code}/join`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({name})
      });
      const data = await res.json();
      playerId = data.id;
      document.getElementById('action').style.display = 'block';
    };

    document.getElementById('sendAction').onclick = async () => {
      const text = document.getElementById('actionText').value;
      const code = document.getElementById('code').value;
      await fetch(`/room/${code}/action`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({player_id: playerId, text})
      });
    };
  </script>
</body>
</html>
